---

services: docker

env:
  matrix:
  - distro: centos:7
    playbook: test.yml
  - distro: 'ubuntu:16.04'
    playbook: test.yml
  - distro: 'ubuntu:18.04'
    playbook: test.yml
  - distro: debian:8
    playbook: test.yml
  - distro: debian:9
    playbook: test.yml
  - distro: debian:10
    playbook: test.yml
  - distro: fedora:27
    playbook: test.yml
  - distro: fedora:28
    playbook: test.yml
  - distro: 'ubuntu:18.04'
    playbook: test_networktopology.yml

matrix:
  allow_failures:
    - env: distro=debian:10 playbook=test.yml
    - env: distro=fedora:28 playbook=test.yml

script:
  # Configure test script so we can run extra tests after playbook is run.
  - export container_id=$(date +%s)
  - export cleanup=false

  # run ci tests
  - ${PWD}/tests/runtests.sh

notifications:
  webhooks: https://galaxy.ansible.com/api/v1/notifications/
